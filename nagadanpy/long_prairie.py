# -*- coding: utf-8 -*-
"""
Created on Sat Apr  4 14:11:20 2020

@author: barne
"""

import matplotlib.pyplot as plt
import numpy as np

from aquifer import Aquifer
from boomerang import boomerang
from herd import Herd
from model import Model
from regionalflow import RegionalFlow
from well import Well


aq = Aquifer(0.0, 12.6, 0.20, 8.46)
re = RegionalFlow(0.0, 0.0, np.array([0.0, 0.0, 0.0, 0.0, 0.0, 0.0]))

w = np.array([
    [355731, 5091141, 0.1524, 1097.55],
    [356276, 5092259, 0.0762, 27.98],
    [356276, 5092259, 0.0762, 100.53],
    [355796, 5091952, 0.0762, 12.43],
    [355800, 5092454, 0.0635, 8.29],
    [356366, 5092269, 0.0762, 89.13],
    [356366, 5092269, 0.0762, 24.87],
    [355674, 5091161, 0.2032, 962.82],
    [355306, 5091163, 0.0508, 8.51],
    [356467, 5092921, 0.1016, 274.64],
    [355736, 5091176, 0.2032, 563.80]
    ])

he = Herd()
for i in np.arange(w.shape[0]):
    he.append(Well(w[i, 0], w[i, 1], w[i, 2], w[i, 3]))

mo = Model(aq, re, he)

obs = np.array([
    [356126, 5093344, 390.72, 2.00],
    [356227, 5093332, 390.72, 2.00],
    [356376, 5093487, 392.34, 2.00],
    [356467, 5092921, 390.66, 2.00],
    [356452, 5092952, 388.80, 2.00],
    [356477, 5092891, 388.68, 2.00],
    [353676, 5092700, 400.23, 2.00],
    [355056, 5092739, 385.88, 2.00],
    [353996, 5092723, 394.59, 2.00],
    [354040, 5092723, 393.89, 2.00],
    [353745, 5092665, 402.21, 2.00],
    [355474, 5092596, 391.18, 2.00],
    [354098, 5092694, 395.26, 2.00],
    [353957, 5092687, 396.61, 2.00],
    [353512, 5092499, 401.18, 2.00],
    [355494, 5092570, 393.47, 2.00],
    [355810, 5092480, 394.23, 2.00],
    [357436, 5092465, 403.68, 2.00],
    [354593, 5092404, 392.89, 2.00],
    [354613, 5092340, 389.81, 2.00],
    [356299, 5092242, 394.78, 2.00],
    [356413, 5092268, 394.96, 2.00],
    [355280, 5092210, 393.80, 2.00],
    [356896, 5092108, 394.38, 2.00],
    [356984, 5092143, 400.42, 2.00],
    [356956, 5092055, 393.34, 2.00],
    [353664, 5092008, 402.95, 2.00],
    [355773, 5091947, 397.73, 2.00],
    [354068, 5091785, 398.04, 2.00],
    [357258, 5091739, 401.67, 2.00],
    [354322, 5091700, 403.86, 2.00],
    [357108, 5091713, 397.28, 2.00],
    [357055, 5091589, 402.34, 2.00],
    [357269, 5091528, 403.62, 2.00],
    [357134, 5091500, 401.88, 2.00],
    [354252, 5091329, 400.57, 2.00],
    [357348, 5091262, 398.37, 2.00],
    [354444, 5091299, 397.61, 2.00],
    [355731, 5091141, 394.81, 2.00],
    [357970, 5091139, 404.41, 2.00],
    [355736, 5091176, 394.62, 2.00],
    [354297, 5091170, 399.23, 2.00],
    [355306, 5091163, 395.08, 2.00],
    [355674, 5091161, 394.35, 2.00],
    [357429, 5091234, 399.87, 2.00],
    [356099, 5090755, 393.44, 2.00],
    [356079, 5090655, 392.67, 2.00],
    [356108, 5090698, 393.68, 2.00],
    [356108, 5090700, 397.09, 2.00],
    [356088, 5090659, 392.77, 2.00],
    [356747, 5090656, 397.92, 2.00],
    [356253, 5090481, 399.04, 2.00],
    [357783, 5090485, 400.96, 2.00],
    [355945, 5090333, 393.19, 2.00],
    [356308, 5090204, 399.87, 2.00],
    [358419, 5090200, 399.53, 2.00],
    [354335, 5090043, 399.90, 2.00],
    [356466, 5090007, 401.39, 2.00],
    [353569, 5089997, 415.72, 2.00],
    [356274, 5090073, 398.77, 2.00],
    [356502, 5089983, 394.59, 2.00],
    [355175, 5089923, 394.29, 2.00],
    [355324, 5089757, 396.54, 2.00],
    [355379, 5089050, 392.37, 2.00],
    [355326, 5089115, 396.70, 2.00],
    [354864, 5088290, 397.25, 2.00],
    [355249, 5088248, 397.06, 2.00]
    ])
kldiv_one, kldiv_two = boomerang(mo, obs)

# Fancy output... Yay!
plt.figure(1)
plt.scatter(np.arange(kldiv_one.shape[0]), kldiv_one[:, -1])

for k in range(5):
    i = kldiv_one[k, 0]
    plt.annotate("%d" % i, (k, kldiv_one[k, -1]))

plt.ylabel('KL Divergence [bits]')
plt.title('Leave One Out', fontsize=28)
plt.show()
plt.savefig('kldiv_one.pdf')

plt.figure(2)
plt.scatter(np.arange(kldiv_two.shape[0]), kldiv_two[:, -1])

for k in range(5):
    i = kldiv_two[k, 0]
    j = kldiv_two[k, 1]
    plt.annotate("%d,%d" % (i, j), (k, kldiv_two[k, -1]))

plt.ylabel('KL Divergence [bits]')
plt.title('Leave Two Out', fontsize=28)
plt.show()
plt.savefig('kldiv_two.pdf')
